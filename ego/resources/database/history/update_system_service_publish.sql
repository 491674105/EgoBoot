
-- 将发布记录表中的system_id字段更新为system_map表的system_id
update ci_task_detail c, system_map s
set c.system_id = s.system_id
where c.system_id = s.business_system
;

-- 获取更新失败的行
select * from ci_task_detail where (system_id REGEXP '[^0-9.]') = 1;

-- 更新服务与系统新元数据的关联
update service set system_id = 1, service_name = 'sisyphe-app-mobile-client', mark = 'APP后端接口' where service_id = 1;
update service set system_id = 1, service_name = 'sisyphe-app-web-client', mark = 'APP后台管理接口' where service_id = 5;
update service set system_id = 1, service_name = 'sisyphe-web-backend', mark = 'APP' where service_id = 2;
update service set system_id = 1, service_name = 'sisyphe-app-backend', mark = 'APP' where service_id = 3;
update service set system_id = 1, service_name = 'sisyphe-app-api', mark = 'APP接口' where service_id = 4;
update service set system_id = 1, service_name = 'sisyphe-obs-cleaner', mark = 'APP清理OBS' where service_id = 269;
update service set system_id = 1, service_name = 'sisyphe-app-android', mark = 'APP安卓更新包' where service_id = 254;
update service set system_id = 1, service_name = 'sisyphe-miniprogram', mark = 'APP小程序' where service_id = 255;
update service set system_id = 1, service_name = 'app-store', mark = 'APP安卓更新包展示页面' where service_id = 271;
update service set system_id = 1, service_name = 'app-mirror-isoasurance', mark = 'APP后台镜像店页面' where service_id = 222;
update service set system_id = 1, service_name = 'oauth-isoasurance', mark = 'APP后台权限页面' where service_id = 227;
update service set system_id = 1, service_name = 'app_admin_web', mark = 'APP后台管理系统页面' where service_id = 180;
update service set system_id = 1, service_name = 'app_admin_web_v2', mark = 'APP后台管理系统v2页面' where service_id = 181;
update service set system_id = 1, service_name = 'app-admin-isoasurance', mark = 'APP后台管理页面' where service_id = 220;
update service set system_id = 1, service_name = 'home-isoasurance', mark = 'APP后台home默认页' where service_id = 221;
update service set system_id = 1, service_name = 'app-mirror', mark = 'app镜像店后台页面' where service_id = 211;
update service set system_id = 1, service_name = 'sisyphe-app-home', mark = 'app落地页页面' where service_id = 183;
update service set system_id = 1, service_name = 'app_h5_web', mark = 'h5页面' where service_id = 182;
update service set system_id = 1, service_name = 'app-wechat', mark = 'H5内嵌企业微信页面' where service_id = 206;
update service set system_id = 16, service_name = 'oa-datasync-task', mark = 'OA系统盖雅' where service_id = 6;
update service set system_id = 129, service_name = 'comments-client', mark = '百感交集' where service_id = 79;
update service set system_id = 129, service_name = 'comments-api', mark = '百感交集' where service_id = 80;
update service set system_id = 130, service_name = 'tag-center-client', mark = '标签中心' where service_id = 272;
update service set system_id = 130, service_name = 'tag-center-api', mark = '标签中心' where service_id = 273;
update service set system_id = 130, service_name = 'label-center', mark = '标签中心页面' where service_id = 275;
update service set system_id = 95, service_name = 'finance-manage-client', mark = '财务系统' where service_id = 8;
update service set system_id = 95, service_name = 'finance-manage-api', mark = '财务系统' where service_id = 155;
update service set system_id = 95, service_name = 'finance-manage-admin', mark = '财务系统' where service_id = 156;
update service set system_id = 95, service_name = 'finance-manage-task', mark = '财务系统' where service_id = 157;
update service set system_id = 95, service_name = 'sisyphe-master-data-job', mark = '预算主数据' where service_id = 37;
update service set system_id = 95, service_name = 'finance-manage-h5', mark = '开票系统-h5页面' where service_id = 224;
update service set system_id = 95, service_name = 'finance-manage', mark = '开票系统后台页面' where service_id = 223;
update service set system_id = 95, service_name = 'tax-management-client', mark = '税率管理' where service_id = 109;
update service set system_id = 95, service_name = 'tax-rate', mark = '税率管理页面' where service_id = 207;
update service set system_id = 99, service_name = 'purchase-system-client', mark = '采控系统' where service_id = 9;
update service set system_id = 99, service_name = 'purchase-system-task', mark = '采控系统' where service_id = 10;
update service set system_id = 99, service_name = 'purchase_web', mark = '采控系统页面' where service_id = 194;
update service set system_id = 38, service_name = 'information-center-manage', mark = '图书检索系统' where service_id = 11;
update service set system_id = 38, service_name = 'information-center-client', mark = '图书检索系统' where service_id = 12;
update service set system_id = 38, service_name = 'information-center-record', mark = '图书检索系统' where service_id = 13;
update service set system_id = 38, service_name = 'information-center-reader', mark = '图书检索系统（门店）' where service_id = 200;
update service set system_id = 38, service_name = 'information_web', mark = '图书检索系统后台页面' where service_id = 186;
update service set system_id = 27, service_name = 'erp_home', mark = '储值卡系统页面' where service_id = 174;
update service set system_id = 27, service_name = 'askcard-client', mark = '储值卡系统' where service_id = 14;
update service set system_id = 27, service_name = 'askcard-manage', mark = '储值卡系统' where service_id = 15;
update service set system_id = 27, service_name = 'askcard-excel', mark = '储值卡系统' where service_id = 16;
update service set system_id = 27, service_name = 'prepaid-card-client', mark = '储值卡系统（新）' where service_id = 160;
update service set system_id = 27, service_name = 'prepaid-card-api', mark = '储值卡系统（新）' where service_id = 228;
update service set system_id = 27, service_name = 'stored-value-card', mark = '储值卡系统（新）页面' where service_id = 217;
update service set system_id = 42, service_name = 'datawarehouse', mark = '大数据' where service_id = 235;
update service set system_id = 42, service_name = 'datawarehouse-ods', mark = '大数据' where service_id = 236;
update service set system_id = 42, service_name = 'cluster-infras', mark = '大数据' where service_id = 237;
update service set system_id = 42, service_name = 'dwh_pub_dim', mark = '大数据' where service_id = 238;
update service set system_id = 42, service_name = 'dwh_pub_fact', mark = '大数据' where service_id = 239;
update service set system_id = 42, service_name = 'dwh_stock', mark = '大数据' where service_id = 240;
update service set system_id = 42, service_name = 'dwh_transfer', mark = '大数据' where service_id = 241;
update service set system_id = 42, service_name = 'dwh_hr', mark = '大数据' where service_id = 242;
update service set system_id = 42, service_name = 'dwh_sale', mark = '大数据' where service_id = 243;
update service set system_id = 42, service_name = 'dwh_purchase', mark = '大数据' where service_id = 244;
update service set system_id = 42, service_name = 'dwh_finance', mark = '大数据' where service_id = 245;
update service set system_id = 42, service_name = 'dwh_flow_control', mark = '大数据' where service_id = 246;
update service set system_id = 42, service_name = 'dwh_budget', mark = '大数据' where service_id = 247;
update service set system_id = 42, service_name = 'dwh_marketing', mark = '大数据' where service_id = 248;
update service set system_id = 42, service_name = 'dwh_mobile_terminal', mark = '大数据' where service_id = 270;
update service set system_id = 42, service_name = 'dwh_stock_check', mark = '大数据' where service_id = 280;
update service set system_id = 96, service_name = 'sisyphe-login', mark = '登录页面' where service_id = 204;
update service set system_id = 96, service_name = 'sso-auth', mark = '登录' where service_id = 17;
update service set system_id = 96, service_name = 'login_web', mark = '登录页面（老）' where service_id = 196;
update service set system_id = 96, service_name = 'sisyphe-passport-api', mark = '账户中心' where service_id = 36;
update service set system_id = 96, service_name = 'sisyphe-passport-web', mark = '账户中心' where service_id = 166;
update service set system_id = 96, service_name = 'sisyphe-passport', mark = '账户中心页面' where service_id = 212;
update service set system_id = 96, service_name = 'finereport-adapter', mark = '账号中心对接帆软登录' where service_id = 165;
update service set system_id = 96, service_name = 'finereport-guider', mark = 'ERP帆软登录服务' where service_id = 7;
update service set system_id = 96, service_name = 'oauth-erp-api', mark = 'ERP权限' where service_id = 86;
update service set system_id = 96, service_name = 'oauth-client', mark = 'ERP权限' where service_id = 87;
update service set system_id = 96, service_name = 'sisyphe-portal-server', mark = 'wifi授权' where service_id = 88;
update service set system_id = 96, service_name = 'sisyphe-wifi-login', mark = 'wifi授权页面' where service_id = 208;
update service set system_id = 96, service_name = 'sisyphe-verification-api', mark = '实名认证' where service_id = 161;
update service set system_id = 90, service_name = 'order-center-api', mark = '订单中心' where service_id = 18;
update service set system_id = 90, service_name = 'order-center-client', mark = '订单中心' where service_id = 19;
update service set system_id = 90, service_name = 'order-center', mark = '订单中心页面' where service_id = 198;
update service set system_id = 28, service_name = 'distribution-receiver-job-new', mark = '分发系统' where service_id = 21;
update service set system_id = 28, service_name = 'distribution-new-client', mark = '分发系统' where service_id = 22;
update service set system_id = 28, service_name = 'distribution_new', mark = '分发系统页面' where service_id = 187;
update service set system_id = 25, service_name = 'member-excel', mark = '会员系统' where service_id = 23;
update service set system_id = 25, service_name = 'member-online-api', mark = '会员系统' where service_id = 24;
update service set system_id = 25, service_name = 'member-online', mark = '会员系统' where service_id = 25;
update service set system_id = 25, service_name = 'member-migration-gz', mark = '会员系统' where service_id = 26;
update service set system_id = 25, service_name = 'member-client', mark = '会员系统' where service_id = 27;
update service set system_id = 25, service_name = 'member-migration-cq', mark = '会员系统' where service_id = 28;
update service set system_id = 25, service_name = 'receive-integration', mark = '会员系统接收益华积分同步' where service_id = 89;
update service set system_id = 25, service_name = 'wechat_web', mark = '会员微信公众号' where service_id = 215;
update service set system_id = 25, service_name = 'feedback-client', mark = '会员意见反馈' where service_id = 121;
update service set system_id = 40, service_name = 'boot-admin', mark = 'boot-admin' where service_id = 167;
update service set system_id = 40, service_name = 'xxl-job-admin', mark = 'xxl中间件' where service_id = 32;
update service set system_id = 40, service_name = 'message-api', mark = '消息平台' where service_id = 33;
update service set system_id = 40, service_name = 'ctrip-web', mark = '企业微信接入携程' where service_id = 34;
update service set system_id = 40, service_name = 'sisyphe-wxwork-ctrip', mark = '企业微信接入携程页面' where service_id = 214;
update service set system_id = 40, service_name = 'sisyphe-rocketmq-extend-client', mark = 'rocketmq管理' where service_id = 35;
update service set system_id = 40, service_name = 'sms-client', mark = '短信系统' where service_id = 20;
update service set system_id = 40, service_name = 'layout-web-generator', mark = '开发插件（许庆）' where service_id = 234;
update service set system_id = 40, service_name = 'task-timer', mark = '开发倒计时服务（汤超）' where service_id = 263;
update service set system_id = 40, service_name = 'sentinel-dashboard', mark = 'sentinel流量控制' where service_id = 276;
update service set system_id = 40, service_name = 'rocketmq-sample', mark = '消息队列测试' where service_id = 260;
update service set system_id = 40, service_name = 'msg-center-client', mark = '消息中心' where service_id = 114;
update service set system_id = 40, service_name = 'sisyphe-sensitivity-client', mark = '敏感词' where service_id = 70;
update service set system_id = 40, service_name = 'sensitive-words', mark = '敏感词过滤管理后台页面' where service_id = 205;
update service set system_id = 40, service_name = 'biz-ops-system-client', mark = '后端运维管理系统客户端' where service_id = 153;
update service set system_id = 40, service_name = 'biz-ops-system-task', mark = '后端运维管理系统定时任务' where service_id = 154;
update service set system_id = 40, service_name = 'sensebot-web', mark = '场景验证' where service_id = 69;
update service set system_id = 40, service_name = 'sensebot-api', mark = '场景验证' where service_id = 71;
update service set system_id = 131, service_name = 'borrow-book-client', mark = '借书系统' where service_id = 277;
update service set system_id = 131, service_name = 'borrow-book-api', mark = '借书系统' where service_id = 278;
update service set system_id = 131, service_name = 'book-borrowing', mark = '借书系统页面' where service_id = 279;
update service set system_id = 13, service_name = 'baseinfo-erp-api', mark = '咖啡ERP基础资料' where service_id = 29;
update service set system_id = 13, service_name = 'coffee-baseinfo', mark = '咖啡ERP基础资料' where service_id = 30;
update service set system_id = 13, service_name = 'coffee-baseinfo-client', mark = '咖啡ERP基础资料' where service_id = 31;
update service set system_id = 13, service_name = 'baseinfo-excel', mark = '咖啡ERP基础资料导出' where service_id = 40;
update service set system_id = 13, service_name = 'base_web', mark = '咖啡ERP基础资料页面' where service_id = 177;
update service set system_id = 13, service_name = 'coffee-stock-api', mark = '咖啡ERP库存冲减接口' where service_id = 39;
update service set system_id = 13, service_name = 'coffee-stock-client', mark = '咖啡ERP库存冲减查询端' where service_id = 45;
update service set system_id = 13, service_name = 'coffee-stock-excel', mark = '咖啡ERP库存冲减导出' where service_id = 47;
update service set system_id = 13, service_name = 'coffee-stock-receiver', mark = '咖啡ERP库存冲减消息接收端' where service_id = 48;
update service set system_id = 13, service_name = 'coffee-bill-client', mark = '咖啡ERP单据客户端' where service_id = 41;
update service set system_id = 13, service_name = 'coffee-bill-api', mark = '咖啡ERP单据接口' where service_id = 43;
update service set system_id = 13, service_name = 'coffee-bill-task', mark = '咖啡ERP单据定时任务' where service_id = 46;
update service set system_id = 13, service_name = 'coffee-report-excel', mark = '咖啡ERP运营日志导出' where service_id = 42;
update service set system_id = 13, service_name = 'coffee-report-client', mark = '咖啡ERP运营日志API接口' where service_id = 44;
update service set system_id = 13, service_name = 'coffee-bill-new-task', mark = '咖啡ERP2.0单据' where service_id = 264;
update service set system_id = 13, service_name = 'coffee-bill-new-client', mark = '咖啡ERP2.0单据' where service_id = 265;
update service set system_id = 13, service_name = 'coffee-batch-offset-client', mark = '咖啡ERP2.0批次冲减' where service_id = 267;
update service set system_id = 13, service_name = 'coffee-batch-offset-api', mark = '咖啡ERP2.0批次冲减' where service_id = 268;
update service set system_id = 13, service_name = 'bill_web', mark = '咖啡ERP单据页面' where service_id = 172;
update service set system_id = 13, service_name = 'sale_web', mark = '咖啡ERP零售页面' where service_id = 173;
update service set system_id = 13, service_name = 'stock_web', mark = '咖啡ERP库存页面' where service_id = 179;
update service set system_id = 13, service_name = 'coffee_report_web', mark = '咖啡运营日志页面' where service_id = 178;
update service set system_id = 13, service_name = 'book-offset-client', mark = '书店ERP批次冲减客户端' where service_id = 90;
update service set system_id = 13, service_name = 'book-offset-api', mark = '书店ERP批次冲减接口' where service_id = 91;
update service set system_id = 13, service_name = 'book-bill-task', mark = '书店ERP单据' where service_id = 92;
update service set system_id = 13, service_name = 'book-bill-client', mark = '书店ERP单据' where service_id = 93;
update service set system_id = 13, service_name = 'book_erp', mark = '书店ERP页面' where service_id = 185;
update service set system_id = 13, service_name = 'sisyphe-erp', mark = 'ERP系统页面' where service_id = 213;
update service set system_id = 13, service_name = 'operation-log', mark = '书店营运日志页面' where service_id = 197;
update service set system_id = 13, service_name = 'book-operation-log-client', mark = '书店营运日志' where service_id = 125;
update service set system_id = 13, service_name = 'behavior-log', mark = '零售端行为日志页面' where service_id = 126;
update service set system_id = 13, service_name = 'operationManagement_web', mark = '营运报表' where service_id = 176;
update service set system_id = 13, service_name = 'finance_web', mark = '财务报表' where service_id = 175;
update service set system_id = 13, service_name = 'file-client', mark = '文件下载' where service_id = 110;
update service set system_id = 13, service_name = 'wms-ext-client', mark = '物流/WMS' where service_id = 111;
update service set system_id = 13, service_name = 'wms-db-ext-client', mark = '物流/WMS' where service_id = 112;
update service set system_id = 13, service_name = 'wms-ext-api', mark = '物流/WMS' where service_id = 113;
update service set system_id = 13, service_name = 'sisypheAdmin', mark = '西西弗前端管理页面' where service_id = 192;
update service set system_id = 132, service_name = 'sisyphe-mobile-sale', mark = '零售移动收银端' where service_id = 252;
update service set system_id = 132, service_name = 'sisyphe-sale-coffee', mark = '咖啡零售收银端' where service_id = 250;
update service set system_id = 132, service_name = 'sisyphe-sale-book', mark = '书店零售收银端' where service_id = 249;
update service set system_id = 132, service_name = 'sale-management', mark = '零售端V3后台管理页面' where service_id = 202;
update service set system_id = 132, service_name = 'book-sale-manage', mark = '零售端V3零售后端' where service_id = 49;
update service set system_id = 132, service_name = 'book-sale-extension', mark = '零售端V3零售后端' where service_id = 50;
update service set system_id = 132, service_name = 'book-sale-client', mark = '零售端V3零售后端' where service_id = 95;
update service set system_id = 132, service_name = 'retail-system-manage', mark = '零售端V3零售后端' where service_id = 51;
update service set system_id = 132, service_name = 'retail-system-task', mark = '零售端V3零售后端' where service_id = 52;
update service set system_id = 132, service_name = 'retail-system-client', mark = '零售端V3零售后端' where service_id = 94;
update service set system_id = 48, service_name = 'stock-center-task', mark = '库存中心定时任务' where service_id = 53;
update service set system_id = 48, service_name = 'stock-reconciliation-task', mark = '库存中心对账' where service_id = 54;
update service set system_id = 48, service_name = 'stock-center-sale-client', mark = '库存中心销售层' where service_id = 55;
update service set system_id = 48, service_name = 'stock-center-dispatch-client', mark = '库存中心调度层' where service_id = 56;
update service set system_id = 48, service_name = 'stock-center-real-client', mark = '库存中心实物层' where service_id = 57;
update service set system_id = 48, service_name = 'stock-center-client', mark = '库存中心后台管理端' where service_id = 164;
update service set system_id = 68, service_name = 'flow-control-task', mark = '流控系统' where service_id = 63;
update service set system_id = 68, service_name = 'flow-control-calculator-api', mark = '流控系统' where service_id = 64;
update service set system_id = 68, service_name = 'flow-control-client', mark = '流控系统' where service_id = 65;
update service set system_id = 68, service_name = 'flow-control-replenishment-task', mark = '流控系统' where service_id = 66;
update service set system_id = 68, service_name = 'flow-control-api', mark = '流控系统' where service_id = 67;
update service set system_id = 68, service_name = 'flowControl_web', mark = '流控系统' where service_id = 188;
update service set system_id = 68, service_name = 'booart-flow-control-client', mark = '不二流控' where service_id = 68;
update service set system_id = 68, service_name = 'booart-flow-control', mark = '不二流控页面' where service_id = 209;
update service set system_id = 103, service_name = 'portal', mark = '门户首页' where service_id = 256;
update service set system_id = 103, service_name = 'sisyphe_com_cn_web', mark = '官网' where service_id = 184;
update service set system_id = 62, service_name = 'check-inventory-app', mark = '盘点手持APP' where service_id = 251;
update service set system_id = 62, service_name = 'stock-pick-system-job', mark = '新盘点系统' where service_id = 75;
update service set system_id = 62, service_name = 'stock-pick-system-manage', mark = '新盘点系统' where service_id = 77;
update service set system_id = 62, service_name = 'stock-pick-system-client', mark = '新盘点系统' where service_id = 78;
update service set system_id = 62, service_name = 'new_inventory', mark = '盘点系统页面' where service_id = 190;
update service set system_id = 62, service_name = 'check-inventory', mark = '盘点系统页面（新）' where service_id = 199;
update service set system_id = 62, service_name = 'newstore-stocktaking-client', mark = '架存系统（老）新店盘点' where service_id = 72;
update service set system_id = 62, service_name = 'newstore-stocktaking-app', mark = '架存系统（老）新店盘点' where service_id = 73;
update service set system_id = 62, service_name = 'newstore-stocktaking-excel', mark = '架存系统（老）新店盘点' where service_id = 76;
update service set system_id = 62, service_name = 'shelf-system-client', mark = '架存系统（新）' where service_id = 158;
update service set system_id = 62, service_name = 'shelf-system-manage', mark = '架存系统（新）' where service_id = 159;
update service set system_id = 62, service_name = 'shelf-storage-management', mark = '架存系统（新）管理端页面' where service_id = 216;
update service set system_id = 62, service_name = 'shelf-storage-app', mark = '架存系统（新）安卓APP' where service_id = 253;
update service set system_id = 37, service_name = 'market-report-excel', mark = '商场数据提报' where service_id = 81;
update service set system_id = 37, service_name = 'market-report-task', mark = '商场数据提报' where service_id = 82;
update service set system_id = 37, service_name = 'market-report-client', mark = '商场数据提报' where service_id = 83;
update service set system_id = 37, service_name = 'data_report', mark = '商场数据提报页面' where service_id = 189;
update service set system_id = 36, service_name = 'product-center-command', mark = '商品中心' where service_id = 84;
update service set system_id = 36, service_name = 'product-center-query', mark = '商品中心' where service_id = 85;
update service set system_id = 36, service_name = 'product_center_web', mark = '商品中心页面' where service_id = 193;
update service set system_id = 58, service_name = 'datacenter-exchange', mark = '数据交换中心' where service_id = 96;
update service set system_id = 58, service_name = 'datacenter-wms-consumer', mark = '数据交换中心' where service_id = 97;
update service set system_id = 58, service_name = 'datacenter-distribution-consumer', mark = '数据交换中心' where service_id = 98;
update service set system_id = 58, service_name = 'datacenter-product-center-producer', mark = '数据交换中心' where service_id = 99;
update service set system_id = 58, service_name = 'data-exchange-yhbill', mark = '数据交换中心' where service_id = 100;
update service set system_id = 58, service_name = 'data-exchange', mark = '数据交换中心' where service_id = 101;
update service set system_id = 58, service_name = 'datacenter-coffee-receiver', mark = '数据交换中心' where service_id = 102;
update service set system_id = 58, service_name = 'datacenter-coffee-baseinfo-producer', mark = '数据交换中心' where service_id = 103;
update service set system_id = 58, service_name = 'datacenter-coffee-producer', mark = '数据交换中心' where service_id = 104;
update service set system_id = 58, service_name = 'datacenter-yh-receiver', mark = '数据交换中心' where service_id = 105;
update service set system_id = 58, service_name = 'datacenter-yh-baseinfo-api', mark = '数据交换中心' where service_id = 106;
update service set system_id = 58, service_name = 'datacenter-distribution-producer', mark = '数据交换中心' where service_id = 107;
update service set system_id = 58, service_name = 'datacenter-coffee-baseinfo-api', mark = '数据交换中心' where service_id = 108;
update service set system_id = 58, service_name = 'datacenter-yh-runner', mark = '数据交换中心' where service_id = 168;
update service set system_id = 58, service_name = 'datacenter-wms-producer', mark = '数据交换中心' where service_id = 169;
update service set system_id = 84, service_name = 'report-gateway', mark = '网关系统（report-fr流量）' where service_id = 115;
update service set system_id = 84, service_name = 'open-gateway', mark = '网关系统（open流量）' where service_id = 116;
update service set system_id = 84, service_name = 'app-gateway', mark = '网关系统（mobile.api流量）' where service_id = 117;
update service set system_id = 84, service_name = 'erp-mgmt-gateway', mark = '网关系统（erp/up/下载/报表流量）' where service_id = 118;
update service set system_id = 84, service_name = 'mgmt-gateway', mark = '网关系统（s/feeling/select流量）' where service_id = 119;
update service set system_id = 84, service_name = 'sale-gateway', mark = '网关系统（bss/login/pay流量）' where service_id = 120;
update service set system_id = 84, service_name = 'support-gateway-v2', mark = '网关系统（support开票流量）' where service_id = 218;
update service set system_id = 84, service_name = 'app-mgmt-gateway-v2', mark = '网关系统（app-admin流量）' where service_id = 219;
update service set system_id = 84, service_name = 'it-ops-gateway-v2', mark = '网关系统(itops流量)' where service_id = 225;
update service set system_id = 84, service_name = 'app-mini-gateway-v2', mark = '网关系统(APP小程序miniprogram流量)' where service_id = 229;
update service set system_id = 84, service_name = 'portal-gateway-v2', mark = '网关系统（门户portal流量）' where service_id = 259;
update service set system_id = 84, service_name = 'security-client', mark = '网关系统（erp/up鉴权）' where service_id = 38;
update service set system_id = 84, service_name = 'erp-mgmt-gateway-v2', mark = '网关系统（erp/up/下载/报表流量）' where service_id = 146;
update service set system_id = 84, service_name = 'mgmt-gateway-v2', mark = '网关系统（s/feeling/select流量）' where service_id = 147;
update service set system_id = 84, service_name = 'sale-gateway-v2', mark = '网关系统（bss/login/pay流量）' where service_id = 148;
update service set system_id = 84, service_name = 'report-gateway-v2', mark = '网关系统（report-fr流量）' where service_id = 149;
update service set system_id = 84, service_name = 'app-gateway-v2', mark = '网关系统（mobile.api流量）' where service_id = 150;
update service set system_id = 84, service_name = 'open-gateway-v2', mark = '网关系统（open流量）' where service_id = 151;
update service set system_id = 84, service_name = 'sec-ops-gateway-v2', mark = '网关系统（安全）' where service_id = 152;
update service set system_id = 89, service_name = 'marketing-center-client', mark = '营销中心' where service_id = 122;
update service set system_id = 89, service_name = 'marketing-center-api', mark = '营销中心' where service_id = 123;
update service set system_id = 89, service_name = 'marketing-center-rule-api', mark = '营销中心' where service_id = 124;
update service set system_id = 89, service_name = 'market-center', mark = '营销中心' where service_id = 203;
update service set system_id = 89, service_name = 'market-center-app', mark = '营销中心' where service_id = 274;
update service set system_id = 89, service_name = 'activity_web', mark = '老活动系统页面' where service_id = 171;
update service set system_id = 89, service_name = 'coffee-activity-task', mark = '老活动系统' where service_id = 58;
update service set system_id = 89, service_name = 'coffee-activity-coupon', mark = '老活动系统' where service_id = 59;
update service set system_id = 89, service_name = 'activity-excel', mark = '老活动系统' where service_id = 60;
update service set system_id = 89, service_name = 'coffee-activity-client', mark = '老活动系统' where service_id = 61;
update service set system_id = 89, service_name = 'sisyphe-adapter-api', mark = '老活动会员积分优惠券' where service_id = 62;
update service set system_id = 72, service_name = 'user-center', mark = '用户中心页面' where service_id = 201;
update service set system_id = 72, service_name = 'user-center-client', mark = '用户中心' where service_id = 129;
update service set system_id = 72, service_name = 'user-center-api', mark = '用户中心' where service_id = 130;
update service set system_id = 72, service_name = 'user-center-web', mark = '用户中心' where service_id = 133;
update service set system_id = 72, service_name = 'integral-center-client', mark = '用户积分中心' where service_id = 127;
update service set system_id = 72, service_name = 'integral-center-api', mark = '用户积分中心' where service_id = 131;
update service set system_id = 72, service_name = 'oauth-sync', mark = '预发布账户同步' where service_id = 232;
update service set system_id = 72, service_name = 'itops', mark = 'itops页面' where service_id = 226;
update service set system_id = 97, service_name = 'sec-ops-web', mark = '安全网关' where service_id = 162;
update service set system_id = 97, service_name = 'sec-ops-gateway', mark = '安全网关' where service_id = 163;
update service set system_id = 97, service_name = 'vue-yw-sec-web', mark = '安全网关页面' where service_id = 210;
update service set system_id = 97, service_name = 'cmdb_service', mark = '运维工单及安全管理系统' where service_id = 266;
update service set system_id = 80, service_name = 'new-station-api', mark = '新站点系统' where service_id = 134;
update service set system_id = 80, service_name = 'new-station-client', mark = '新站点系统' where service_id = 135;
update service set system_id = 80, service_name = 'station_web', mark = '新站点系统页面' where service_id = 191;
update service set system_id = 55, service_name = 'payment-webmanager', mark = '支付系统' where service_id = 136;
update service set system_id = 55, service_name = 'payment-scheduler', mark = '支付系统' where service_id = 137;
update service set system_id = 55, service_name = 'payment-client-old', mark = '支付系统（老）' where service_id = 138;
update service set system_id = 55, service_name = 'payment-auxiliary-app', mark = '支付系统' where service_id = 139;
update service set system_id = 55, service_name = 'payment-gateway', mark = '支付系统' where service_id = 140;
update service set system_id = 55, service_name = 'payment-client', mark = '支付系统' where service_id = 141;
update service set system_id = 55, service_name = 'pay_web', mark = '支付系统页面' where service_id = 195;
update service set system_id = 55, service_name = 'receipt-sale-client', mark = '小票模板' where service_id = 142;
update service set system_id = 100, service_name = 'repeat-card-client', mark = '重复卡系统' where service_id = 143;
update service set system_id = 100, service_name = 'repeat-card-system-api', mark = '重复卡系统' where service_id = 144;
update service set system_id = 100, service_name = 'repeat-card-web', mark = '重复卡系统页面' where service_id = 145;

-- 更新部分系统名称
update system_map set business_system = '大数据平台' where system_id = 42;
update system_map set business_system = '安全运维管理平台' where system_id = 97;

-- 删除无效的系统信息
delete from system_map
where system_id in (
    select
        base.system_id
    from (
        select
            sm.system_id,
            sm.business_system,
            s.service_id,
            s.service_name
        from system_map sm
        left join service s on s.system_id = sm.system_id
    ) base
    where
        base.service_id is null
)
;
